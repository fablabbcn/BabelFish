// dot -Tpng fsm.dot -o stk500v2.png

digraph stk500v2 {
	node [shape = circle];
        sSTART -> sSEQNUM [label = "received MESSAGE_START"];
        sSTART -> sSTART [label = "Didn't receive MESSAGE_START"];
        sSEQNUM -> sSIZE1 [label = "Got the #command_sequence (increment)"];
        sSEQNUM -> sSTART [label = "Got wrong command sequence"];
        sSIZE1 -> sSIZE2 [label = "Got message LSB of length"];
        sSIZE2 -> sTOKEN [label = "Got message MSB of length"];
        sTOKEN -> sDATA [label = "Got TOKEN"];
        sTOKEN -> sSTART [label = "Didn't get TOKEN"];
        sDATA -> ERROR [label = "Exceeds maximum message size (-2)"];
        sDATA -> ERROR [label = "Zero length (-3)"];
        sDATA -> ERROR [label = "Bad sent checksum (-3)"];
        sDATA -> sCSUM [label = "Reached message length"];
        sDATA -> sDATA [label = "Receive byte"];
        sCSUM -> sDONE [label = "checksum is 0"];
        sCSUM -> ERROR [label = "Bad checksum (-4)"];
}
